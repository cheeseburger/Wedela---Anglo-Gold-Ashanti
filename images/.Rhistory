    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Cd", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Cd.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Bi", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Bi.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="K", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_K.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Ge", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Ge.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="In", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_In.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Fe", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Fe.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="P", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_P.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="As", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_As.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Sn", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Sn.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Li", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Li.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Cl", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Cl.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Se", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Se.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Sb", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Sb.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Na", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Na.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Ca", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Ca.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Br", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Br.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="I", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_I.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Mg", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Mg.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Ti", y=i)) +
    geom_jitter() + stat_cor(method = "pearson", label.x = 0.01, label.y = -0.08) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Pearson_CorrPlot_Wedela", i, "_Ti.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Rb", y=i)) +
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Mn", y=i, color="Size")) +
    geom_jitter() + 
    ylab(paste(i)) 
    plot_list[[i]] = plt
}
for (i in colNames)
{
    file_name = paste("Frac_CorrPlot_VTAPA", i, "_Mn.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
plot_list = list()
colNames <- names(xrfM)[7:55]
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Mn", y=i, color="Size")) +
    geom_jitter() + 
    ylab(paste(i)) 
    plot_list[[i]] = plt
}
for(i in colNames)
{
    plt <- ggplot(xrfM, aes_string(x="Mn", y=i, color="Size")) +
    geom_jitter() + 
    ylab(paste(i)) 
    plot_list[[i]] = plt
}
jfor (i in colNames)
{
    file_name = paste("Frac_CorrPlot_Wedela", i, "_Mn.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
for (i in colNames)
{
    file_name = paste("Frac_CorrPlot_Wedela", i, "_Mn.png", sep="")
    png(file_name, width = 8 * 500, height = 4 * 500, res = 300)
    print(plot_list[[i]])
    dev.off()
}
rs.restartR()
library(tidyverse)
select(df)
select(df, names(df)[3:51])
df
head(df)
xrfM
select(df, names(xrfM)[3:51])
select(df, names(xrfM)[5:57])
df <- read.csv("Wedela_2018_csv.csv", header=TRUE, sep=",")
df <- read.csv("Wadela_2018_csv.csv", header=TRUE, sep=",")
select(df, names(df)[3:51])
select(df, names(df)[3:50])
library(tidyverse)
library(ggplot2)
library(reshape2)
library(viridis)
library(rgdal)
library(grid)
library(outliers)
library(readr)
library(gridExtra)
library(raster)
library(GSODR)
library(future)
library(rgeos)
library(sp)
library(lubridate)
library(rio)
library(data.table)
theme_set(theme_minimal(base_size=22)) 
xrf <- import_list("Wadela_2018.xlsx")
xrfM <- rbindlist(list(
xrf$Wadela_Aut_2018_Coarse, xrf$Wadela_Winter_2018_Coarse,
xrf$Wadela_August_2018_Coarse, xrf$Wadela_Aut_2018_Fine,
xrf$Wadela_Winter_2018_Fine, xrf$Wadela_August_2018_Fine))[order(Seq)]
ggplot(xrfM, aes(DoW, Size, color=Size)) +
geom_jitter() + geom_boxplot() +
xlim("Mon","Tue","Wed","Thu","Fri","Sat","Sun") 
scale_x_date(breaks="2 days", date_labels = "%d-%b") +
facet_grid(Size ~ Season, scales="free_x") +
xlab("Date") + ylab("Concentration µgm^3") +
labs(color="Concentration") +
theme(axis.text.x = element_text(angle=90, hjust=1))
df <- rbindlist(list(
xrf$Wadela_Aut_2018_Coarse, xrf$Wadela_Winter_2018_Coarse,
xrf$Wadela_August_2018_Coarse, xrf$Wadela_Aut_2018_Fine,
xrf$Wadela_Winter_2018_Fine, xrf$Wadela_August_2018_Fine))[order(Seq)]
tbl <- names(df)[3:50]
tbl <- c("Size", (names(df)[3:50]))
xrf_tbl <- df %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
plt <- ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) +ylab("Concentration µg cm^3")
plt
df <- rbindlist(list(
xrf$Wadela_Aut_2018_Coarse, xrf$Wadela_Winter_2018_Coarse,
xrf$Wadela_August_2018_Coarse, xrf$Wadela_Aut_2018_Fine,
xrf$Wadela_Winter_2018_Fine, xrf$Wadela_August_2018_Fine))[order(Seq)]
df
head(df)
names(df)[3:50]
names(df)[7:50]
c("Size", (names(df)[7:50]))
tbl <- c("Size", (names(df)[7:50]))
xrf_tbl <- df %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) +ylab("Concentration µg cm^3")
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) +
geom_jitter()
ggplot(df, aes(Size, variable, fill=value)) + geom_raster()
df
ggplot(df, aes(xrf_tbl, variable, fill=value)) + geom_raster()
xrf_tbl
head(xrf_tbl)
ggplot(df, aes(xrf_tbl, variable, fill=value)) + geom_raster()
ggplot(xrf_tbl, aes(variable, size, fill=value)) + geom_raster()
ggplot(xrf_tbl, aes(variable, Size, fill=value)) + geom_raster()
ggplot(xrf_tbl, aes(variable, Size, fill=value)) + geom_raster()
ggplot(xrf_tbl, aes(variable, Size, fill=value)) + geom_raster() +
ggplot(xrf_tbl, aes(variable, Size, fill=value)) + geom_raster() +
scale_fill_viridis()
dfnrm <- df
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50])
for (i in colNames)
{
    dfnrm[[i]] <- (mynrm(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
dfnrm <- df
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50]
for (i in colNames)
{
    dfnrm[[i]] <- (mynrm(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
xrf_tblnrm <- dfnrm %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
ggplot(xrf_tblnrm, aes(variable, Size, fill=value)) + geom_raster() +
scale_fill_viridis()
dfnrm <- df
myscaled <- function(x){(x-min(x))/(max(x)-min(x))}
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50]
for (i in colNames)
{
    dfnrm[[i]] <- (myscaled(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
xrf_tblnrm <- dfnrm %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
ggplot(xrf_tblnrm, aes(variable, Size, fill=value)) + geom_raster() +
scale_fill_viridis()
df
head(df)
unique(df$Sample Name)
unique(df$Sample)
unique(df$ResultType)
tbl <- c("Size", "Sample" (names(df)[7:50]))
df$tbl <- c("Size", "Sample Name" (names(df)[7:50]))
tbl <- c("Size", "Sample Name" (names(df)[7:50]))
tbl <- c("Size", "Sample.Name" (names(df)[7:50]))
df$Sample Name
df$Sample 
ggplot(xrf_tblnrm, aes(variable, Size, fill=value)) + geom_raster() +
scale_fill_viridis() + facet_grid(~ "Sample Name")
scale_fill_viridis() + facet_grid("Sample Name" ~ .)
ggplot(df, aes(Date, Concentration_µgm3, color=Size)) +
geom_jitter() + geom_smooth() +
scale_x_date(breaks="2 days", date_labels = "%d-%b") +
facet_grid(Size ~ Season, scales="free_x") +
xlab("Date") + ylab("Concentration µgm^3") +
labs(color="Concentration") +
theme(axis.text.x = element_text(angle=90, hjust=1))
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) +ylab("Concentration µg cm^3")
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) + facet_grid(variable ~, scales="free_y") + ylab("Concentration µg cm^3")
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) + facet_grid(variable ~ ., scales="free_y") + ylab("Concentration µg cm^3")
ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) + facet_grid(~ variable, scales="free_y") + ylab("Concentration µg cm^3")
plt <- ggplot(xrf_tbl, aes(variable, value, fill=Size, color=Size)) + geom_boxplot() +
geom_jitter(alpha=0.05) + theme(axis.text.x=element_text(angle=90,
hjust=1)) + facet_grid(~ variable, scales="free_x") + ylab("Concentration µg cm^3")
plt
xrf <- import_list("Wadela_2018.xlsx")
df <- rbindlist(list(
xrf$Wadela_Aut_2018_Coarse, xrf$Wadela_Winter_2018_Coarse,
xrf$Wadela_August_2018_Coarse, xrf$Wadela_Aut_2018_Fine,
xrf$Wadela_Winter_2018_Fine, xrf$Wadela_August_2018_Fine))[order(Seq)]
tbl <- names(df)[7:50]
tbl <- c("Size", "SampleName" (names(df)[7:50]))
xrf_tbl <- df %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
dfnrm <- df
myscaled <- function(x){(x-min(x))/(max(x)-min(x))}
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50]
for (i in colNames)
{
    dfnrm[[i]] <- (myscaled(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
xrf_tblnrm <- dfnrm %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size, -Sample)
tbl <- names(df)[7:50]
tbl <- c("Size", "SampleName" (names(df)[7:50]))
tbl <- names(df)[7:50]
tbl <- c("Size", "SampleName", (names(df)[7:50]))
xrf_tbl <- df %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size)
dfnrm <- df
myscaled <- function(x){(x-min(x))/(max(x)-min(x))}
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50]
for (i in colNames)
{
    dfnrm[[i]] <- (myscaled(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
xrf_tblnrm <- dfnrm %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size, -Sample)
xrf_tbl <- df %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size, -SampleName)
dfnrm <- df
myscaled <- function(x){(x-min(x))/(max(x)-min(x))}
mynrm <- function(x)(x/(mean(x)))
colNames <- names(dfnrm)[7:50]
for (i in colNames)
{
    dfnrm[[i]] <- (myscaled(dfnrm[[i]][!is.na(dfnrm[[i]])]))
}
xrf_tblnrm <- dfnrm %>%
dplyr::select(tbl) %>%
gather(key="variable", value="value", -Size, -SampleName)
ggplot(xrf_tblnrm, aes(x=SampleName, y=Size, fill=variable)) + geom_raster()
ggplot(xrf_tblnrm, aes(x=SampleName, y=variable)) + geom_raster()
ggplot(xrf_tblnrm, aes(y=SampleName, x=variable)) + geom_raster()
ggplot(xrf_tblnrm, aes(y=SampleName, x=variable, fill=Size)) + geom_raster()
ggplot(xrf_tblnrm, aes(fill=SampleName, x=variable, y=Size)) + geom_raster()
